(this["webpackJsonpimage-gallery"]=this["webpackJsonpimage-gallery"]||[]).push([[0],{76:function(e,t,r){},77:function(e,t,r){"use strict";r.r(t);var n=r(1),c=r(0),a=r.n(c),s=r(22),o=r.n(s),i=r(19),l=r(18),j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_PHOTOS":return t.photos;default:return e}},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_ERRORS":return t.errors;default:return e}},b=r(43),d=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||l.d,h=Object(l.e)(Object(l.c)({photos:j,errors:u}),d(Object(l.a)(b.a))),m=r(13),O=r(6),p=r(24),f=r.n(p),g=function(e,t){return f.a.get(e)},x=function(e,t){var r,n;r="token",n=e.data.token,f.a.set(r,n,{expires:1}),function(e,t){localStorage.setItem(e,JSON.stringify(t))}("user",e.data.user),t()},v=function(e){var t;t="token",f.a.remove(t),function(e){localStorage.removeItem(e)}("user"),e.push("/login")},N=Object(O.g)((function(e){var t=e.history;return Object(n.jsxs)("header",{children:[Object(n.jsx)("h1",{children:"PhotoGalleryApp"}),Object(n.jsx)("div",{className:"links",children:g("token")?Object(n.jsxs)(n.Fragment,{children:[" ",Object(n.jsx)(m.c,{to:"/",className:"link",children:"Home"}),Object(n.jsx)(m.c,{to:"/gallery",className:"link",children:"Gallery"}),Object(n.jsx)(m.c,{to:"/gallery",onClick:function(){return v(t)},className:"link",children:"Logout"})]}):Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(m.c,{to:"/login",className:"link",children:"Login"}),Object(n.jsx)(m.c,{to:"/register",className:"link",children:"Register"})]})})]})})),y=r(16),E=r(78),S=r(80),w=r(21),k=r.n(w),T=r(31),L=r(17),R=r.n(L),_="https://shubhamgupta47-image-gallery-api.glitch.me",C=function(e){return{type:"GET_ERRORS",errors:e}},P=function(e){return{type:"LOAD_PHOTOS",photos:e}},D=Object(i.b)((function(e){return{photos:e.photos||[],errors:e.errors||{}}}))((function(e){var t=e.errors,r=e.dispatch,s=Object(c.useState)(null),o=Object(y.a)(s,2),i=o[0],l=o[1],j=Object(c.useState)(!1),u=Object(y.a)(j,2),b=u[0],d=u[1],h=Object(c.useState)(null),m=Object(y.a)(h,2),O=m[0],p=m[1];Object(c.useEffect)((function(){p("Upload failed. Please try again.")}),[t.uploadError]),Object(c.useEffect)((function(){p("")}),[]);return Object(n.jsxs)(a.a.Fragment,{children:[O?Object(n.jsx)("p",{className:"errorMsg centered-message",children:O}):b&&Object(n.jsx)("p",{className:"successMsg centered-message",children:"Photo uploaded successfully."}),Object(n.jsxs)(E.a,{onSubmit:function(e){e.preventDefault(),i&&(p(""),r(function(e){return function(){var t=Object(T.a)(k.a.mark((function t(r){var n;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(n=new FormData).append("photo",e),t.next=5,R.a.post("".concat(_,"/photos"),n,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(g("token"))}});case 5:t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),t.t0.response&&r(C({uploadError:t.t0.response}));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()}(i)),d(!0))},method:"post",encType:"multipart/form-data",className:"upload-form",children:[Object(n.jsxs)(E.a.Group,{children:[Object(n.jsx)(E.a.Label,{children:"Choose photo to upload"}),Object(n.jsx)(E.a.Control,{type:"file",name:"photo",onChange:function(e){var t=e.target.files[0];l(t)}})]}),Object(n.jsx)(S.a,{variant:"primary",type:"submit",className:"".concat(i?"submit-btn":"disabled submit-btn"),disabled:!i,children:"Upload"})]})]})})),I=function(){var e=function(){if(g("token")&&localStorage.getItem("user"))return JSON.parse(localStorage.getItem("user"))}().name;return Object(n.jsxs)("div",{className:"home-page",children:["Welcome ",e,Object(n.jsx)(D,{})]})},G=r(79),A=function(e){var t=e.id;return Object(n.jsx)(G.a,{className:"photo",children:Object(n.jsx)(G.a.Img,{variant:"top",src:"".concat(_,"/photos/").concat(t),alt:"Photo"})})},F=Object(i.b)((function(e){return{photos:e.photos||[],errors:e.errors||{}}}))((function(e){var t=e.errors,r=e.photos,a=e.dispatch,s=Object(c.useState)(!1),o=Object(y.a)(s,2),i=o[0],l=o[1];return Object(c.useEffect)((function(){l(!0),a(function(){var e=Object(T.a)(k.a.mark((function e(t){var r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.a.get("".concat(_,"/photos"),{headers:{Authorization:"Bearer ".concat(g("token"))}});case 3:r=e.sent,t(P(r.data)),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.t0.response&&t(C({fetchingError:e.t0.response}));case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(c.useEffect)((function(){(r.length>0||t.fetchingError&&t.fetchingError.data)&&l(!1)}),[r,t.fetchingError]),Object(n.jsxs)("div",{className:"photos-list",children:[t&&t.fetchingError&&!r.length&&Object(n.jsxs)("p",{className:"errorMsg centered-message",children:["Something doesn't seem right. Please try later.",Object(n.jsxs)("span",{children:["(",t.fetchingError.status,")"]})]}),i?Object(n.jsx)("div",{className:"loading-msg centered-message",children:"Loading..."}):r.map((function(e){return Object(n.jsx)(A,{id:e._id},e._id)}))]})})),M=function(){return Object(n.jsx)("div",{children:Object(n.jsx)("h3",{children:"Sorry, this page does not exist. Please use the links in navigation bar."})})},J=r(11),B=r(7),H=function(e){return Object(n.jsx)("div",{className:"alert alert-success",children:e})},U=function(e){return Object(n.jsx)("div",{className:"alert alert-danger",children:e})},z=Object(O.g)((function(e){var t=e.history,r=Object(c.useState)({email:"",password:"",error:"",success:"",buttonText:"Login"}),a=Object(y.a)(r,2),s=a[0],o=a[1];Object(c.useEffect)((function(){g("token")&&t.push("/")}),[]);var i=s.email,l=s.password,j=s.error,u=s.success,b=s.buttonText,d=function(){return function(e){var t,r=e.target;o(Object(B.a)(Object(B.a)({},s),{},(t={},Object(J.a)(t,r.name,r.value),Object(J.a)(t,"error",""),Object(J.a)(t,"success",""),Object(J.a)(t,"buttonText","Login"),t)))}},h=function(e){e.preventDefault(),o(Object(B.a)(Object(B.a)({},s),{},{buttonText:"Logging in..."})),R.a.post("".concat(_,"/login"),{email:i,password:l}).then((function(e){x(e,(function(){t.push("/")}))})).catch((function(e){o(Object(B.a)(Object(B.a)({},s),{},{error:e.response.data.error,buttonText:"Login"}))}))};return Object(n.jsxs)("div",{className:"col-md-6 offset-md-3",children:[Object(n.jsx)("h1",{className:"mb-4",children:"Login"}),Object(n.jsx)("br",{}),u&&H(u),j&&U(j),Object(n.jsxs)("form",{onSubmit:h,children:[Object(n.jsx)("div",{className:"form-group",children:Object(n.jsx)("input",{value:i,onChange:d(),type:"email",name:"email",className:"form-control",placeholder:"Type Email"})}),Object(n.jsx)("div",{className:"form-group",children:Object(n.jsx)("input",{value:l,onChange:d(),type:"password",name:"password",className:"form-control",placeholder:"Enter password here"})}),Object(n.jsx)("hr",{}),Object(n.jsx)("div",{className:"form-group",children:Object(n.jsx)("button",{className:"btn btn-light",children:b})})]})]})})),X=r(44),V=function(e){var t=e.component,r=Object(X.a)(e,["component"]);return Object(n.jsx)(O.b,Object(B.a)(Object(B.a)({},r),{},{render:function(e){return g("token")?Object(n.jsx)(t,Object(B.a)({},e)):Object(n.jsx)(O.a,{to:"/login"})}}))},W=Object(O.g)((function(){var e=Object(c.useState)({name:"",email:"",password:"",error:"",success:"",buttonText:"Register"}),t=Object(y.a)(e,2),r=t[0],a=t[1],s=r.name,o=r.email,i=r.password,l=r.error,j=r.success,u=r.buttonText,b=function(){return function(e){var t,n=e.target;a(Object(B.a)(Object(B.a)({},r),{},(t={},Object(J.a)(t,n.name,n.value),Object(J.a)(t,"error",""),Object(J.a)(t,"success",""),Object(J.a)(t,"buttonText","Register"),t)))}},d=function(e){e.preventDefault(),a(Object(B.a)(Object(B.a)({},r),{},{buttonText:"Registering"})),R.a.post("".concat(_,"/register"),{name:s,email:o,password:i}).then((function(e){a(Object(B.a)(Object(B.a)({},r),{},{name:"",email:"",password:"",error:"",success:e.data.message,buttonText:"Submitted"}))})).catch((function(e){a(Object(B.a)(Object(B.a)({},r),{},{error:e.response.data.error,buttonText:"Register"}))}))};return Object(n.jsxs)("div",{className:"col-md-6 offset-md-3",children:[Object(n.jsx)("h1",{className:"mb-4",children:"Register"}),Object(n.jsx)("br",{}),l&&U(l),Object(n.jsxs)("form",{onSubmit:d,children:[Object(n.jsx)("div",{className:"form-group",children:Object(n.jsx)("input",{value:s,onChange:b(),type:"text",name:"name",className:"form-control",placeholder:"Type your name"})}),Object(n.jsx)("div",{className:"form-group",children:Object(n.jsx)("input",{value:o,onChange:b(),type:"email",name:"email",className:"form-control",placeholder:"Type Email"})}),Object(n.jsx)("div",{className:"form-group",children:Object(n.jsx)("input",{value:i,onChange:b(),type:"password",name:"password",className:"form-control",placeholder:"Enter password here"})}),Object(n.jsx)("hr",{}),Object(n.jsx)("div",{className:"form-group",children:Object(n.jsx)("button",{className:"btn btn-light",children:u})})]}),j&&Object(n.jsxs)(n.Fragment,{children:[" ",H(j),Object(n.jsx)(m.b,{className:"btn btn-light mb-4 col-md-12",to:"/login",children:"Go to Login"})]})]})})),q=function(){return Object(n.jsx)(m.a,{basename:"/",children:Object(n.jsxs)("div",{children:[Object(n.jsx)(N,{}),Object(n.jsx)("div",{className:"main-content",children:Object(n.jsxs)(O.d,{children:[Object(n.jsx)(V,{component:I,path:"/",exact:!0}),Object(n.jsx)(V,{component:F,path:"/gallery"}),Object(n.jsx)(O.b,{component:z,path:"/login"}),Object(n.jsx)(O.b,{component:W,path:"/register"}),Object(n.jsx)(O.b,{component:M})]})})]})})};r(75),r(76);o.a.render(Object(n.jsx)(a.a.StrictMode,{children:Object(n.jsx)(i.a,{store:h,children:Object(n.jsx)(q,{})})}),document.getElementById("root"))}},[[77,1,2]]]);
//# sourceMappingURL=main.25da2f6e.chunk.js.map