(this["webpackJsonpimage-gallery"]=this["webpackJsonpimage-gallery"]||[]).push([[0],{76:function(e,t,n){},77:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n(0),a=n.n(c),s=n(22),o=n.n(s),i=n(19),l=n(18),u=n(7),j={photos:[],loading:!0},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.photos;switch(n){case"LOAD_PHOTOS":return Object(u.a)(Object(u.a)({},e),{},{photos:r,loading:!1});default:return e}},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_ERRORS":return t.errors;default:return e}},h=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,n=t.type;switch(n){case"UPLOAD_PHOTOS_SUCCESS":return!0;default:return e}},O=n(43),p=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||l.d,m=Object(l.e)(Object(l.c)({gallery:b,errors:d,uploadSuccess:h}),p(Object(l.a)(O.a))),g=n(13),f=n(6),x=n(24),v=n.n(x),N=function(e,t){return v.a.get(e)},y=function(e,t){var n,r;n="token",r=e.data.token,v.a.set(n,r,{expires:1}),function(e,t){localStorage.setItem(e,JSON.stringify(t))}("user",e.data.user),t()},S=function(e){var t;t="token",v.a.remove(t),function(e){localStorage.removeItem(e)}("user"),e.push("/login")},E=Object(f.g)((function(e){var t=e.history;return Object(r.jsxs)("header",{children:[Object(r.jsx)("h1",{children:"PhotoGalleryApp"}),Object(r.jsx)("div",{className:"links",children:N("token")?Object(r.jsxs)(r.Fragment,{children:[" ",Object(r.jsx)(g.c,{to:"/",className:"link",children:"Home"}),Object(r.jsx)(g.c,{to:"/gallery",className:"link",children:"Gallery"}),Object(r.jsx)(g.c,{to:"/gallery",onClick:function(){return S(t)},className:"link",children:"Logout"})]}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(g.c,{to:"/login",className:"link",children:"Login"}),Object(r.jsx)(g.c,{to:"/register",className:"link",children:"Register"})]})})]})})),w=n(16),T=n(78),k=n(80),_=n(21),C=n.n(_),L=n(31),P=n(17),R=n.n(P),D="https://shubhamgupta47-image-gallery-api.glitch.me",U=function(e){return{type:"GET_ERRORS",errors:e}},A=function(e){return{type:"LOAD_PHOTOS",photos:e}},I=function(){return{type:"UPLOAD_PHOTOS_SUCCESS"}},G=Object(i.b)((function(e){return{photos:e.photos||[],errors:e.errors||{},uploadSuccess:e.uploadSuccess}}))((function(e){var t=e.errors,n=e.dispatch,s=e.uploadSuccess,o=Object(c.useState)(null),i=Object(w.a)(o,2),l=i[0],u=i[1],j=Object(c.useState)(null),b=Object(w.a)(j,2),d=b[0],h=b[1],O=Object(c.useState)(!1),p=Object(w.a)(O,2),m=p[0],g=p[1];Object(c.useEffect)((function(){h("Upload failed. Please try again.")}),[t.uploadError]),Object(c.useEffect)((function(){h("")}),[]),Object(c.useEffect)((function(){s&&g(!1)}),[s]);return Object(r.jsxs)(a.a.Fragment,{children:[m&&!d&&Object(r.jsx)("div",{className:"alert alert-secondary",children:"Uploading... "}),d?Object(r.jsx)("p",{className:"errorMsg centered-message",children:d}):s&&!m&&Object(r.jsx)("p",{className:"successMsg centered-message",children:"Photo uploaded successfully."}),Object(r.jsxs)(T.a,{onSubmit:function(e){e.preventDefault(),l&&(h(""),g(!0),n(function(e){return function(){var t=Object(L.a)(C.a.mark((function t(n){var r;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(r=new FormData).append("photo",e),t.next=5,R.a.post("".concat(D,"/photos"),r,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(N("token"))}});case 5:n(I()),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),t.t0.response&&n(U({uploadError:t.t0.response}));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()}(l)))},method:"post",encType:"multipart/form-data",className:"upload-form",children:[Object(r.jsxs)(T.a.Group,{children:[Object(r.jsx)(T.a.Label,{children:"Choose photo to upload"}),Object(r.jsx)(T.a.Control,{type:"file",name:"photo",onChange:function(e){var t=e.target.files[0];u(t)}})]}),Object(r.jsx)(k.a,{variant:"primary",type:"submit",className:"".concat(l?"submit-btn":"disabled submit-btn"),disabled:!l,children:"Upload"})]})]})})),F=function(){var e=function(){if(N("token")&&localStorage.getItem("user"))return JSON.parse(localStorage.getItem("user"))}().name;return Object(r.jsxs)("div",{className:"home-page",children:["Welcome ",e,Object(r.jsx)(G,{})]})},H=n(79),M=function(e){var t=e.id;return Object(r.jsx)(H.a,{className:"photo",children:Object(r.jsx)(H.a.Img,{variant:"top",src:"".concat(D,"/photos/").concat(t),alt:"Photo"})})},J=Object(i.b)((function(e){return{photos:e.gallery.photos||[],loading:e.gallery.loading,errors:e.errors||{}}}))((function(e){var t=e.errors,n=e.photos,a=e.loading,s=e.dispatch;return Object(c.useEffect)((function(){s(function(){var e=Object(L.a)(C.a.mark((function e(t){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.a.get("".concat(D,"/photos"),{headers:{Authorization:"Bearer ".concat(N("token"))}});case 3:n=e.sent,t(A(n.data)),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.t0.response&&t(U({fetchingError:e.t0.response}));case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(r.jsxs)("div",{className:"photos-list",children:[t&&t.fetchingError&&!n.length&&Object(r.jsxs)("p",{className:"errorMsg centered-message",children:["Something doesn't seem right. Please try later.",Object(r.jsxs)("span",{children:["(",t.fetchingError.status,")"]})]}),a&&!t.fetchingError&&Object(r.jsx)("div",{className:"loading-msg centered-message",children:"Loading..."}),a||n.length?n.map((function(e){return Object(r.jsx)(M,{id:e._id},e._id)})):Object(r.jsx)("div",{className:"alert alert-secondary",children:"No photo available. "})]})})),B=function(){return Object(r.jsx)("div",{children:Object(r.jsx)("h3",{children:"Sorry, this page does not exist. Please use the links in navigation bar."})})},z=n(11),X=function(e){return Object(r.jsx)("div",{className:"alert alert-success",children:e})},V=function(e){return Object(r.jsx)("div",{className:"alert alert-danger",children:e})},W=Object(f.g)((function(e){var t=e.history,n=Object(c.useState)({email:"",password:"",error:"",success:"",buttonText:"Login"}),a=Object(w.a)(n,2),s=a[0],o=a[1];Object(c.useEffect)((function(){N("token")&&t.push("/")}),[]);var i=s.email,l=s.password,j=s.error,b=s.success,d=s.buttonText,h=function(){return function(e){var t,n=e.target;o(Object(u.a)(Object(u.a)({},s),{},(t={},Object(z.a)(t,n.name,n.value),Object(z.a)(t,"error",""),Object(z.a)(t,"success",""),Object(z.a)(t,"buttonText","Login"),t)))}},O=function(e){e.preventDefault(),o(Object(u.a)(Object(u.a)({},s),{},{buttonText:"Logging in..."})),R.a.post("".concat(D,"/login"),{email:i,password:l}).then((function(e){y(e,(function(){t.push("/")}))})).catch((function(e){o(Object(u.a)(Object(u.a)({},s),{},{error:e.response.data.error,buttonText:"Login"}))}))};return Object(r.jsxs)("div",{className:"col-md-6 offset-md-3",children:[Object(r.jsx)("h1",{className:"mb-4",children:"Login"}),Object(r.jsx)("br",{}),b&&X(b),j&&V(j),Object(r.jsxs)("form",{onSubmit:O,children:[Object(r.jsx)("div",{className:"form-group",children:Object(r.jsx)("input",{value:i,onChange:h(),type:"email",name:"email",className:"form-control",placeholder:"Type Email"})}),Object(r.jsx)("div",{className:"form-group",children:Object(r.jsx)("input",{value:l,onChange:h(),type:"password",name:"password",className:"form-control",placeholder:"Enter password here"})}),Object(r.jsx)("hr",{}),Object(r.jsx)("div",{className:"form-group",children:Object(r.jsx)("button",{className:"btn btn-light",children:d})})]})]})})),q=n(44),K=function(e){var t=e.component,n=Object(q.a)(e,["component"]);return Object(r.jsx)(f.b,Object(u.a)(Object(u.a)({},n),{},{render:function(e){return N("token")?Object(r.jsx)(t,Object(u.a)({},e)):Object(r.jsx)(f.a,{to:"/login"})}}))},Q=Object(f.g)((function(){var e=Object(c.useState)({name:"",email:"",password:"",error:"",success:"",buttonText:"Register"}),t=Object(w.a)(e,2),n=t[0],a=t[1],s=n.name,o=n.email,i=n.password,l=n.error,j=n.success,b=n.buttonText,d=function(){return function(e){var t,r=e.target;a(Object(u.a)(Object(u.a)({},n),{},(t={},Object(z.a)(t,r.name,r.value),Object(z.a)(t,"error",""),Object(z.a)(t,"success",""),Object(z.a)(t,"buttonText","Register"),t)))}},h=function(e){e.preventDefault(),a(Object(u.a)(Object(u.a)({},n),{},{buttonText:"Registering"})),R.a.post("".concat(D,"/register"),{name:s,email:o,password:i}).then((function(e){a(Object(u.a)(Object(u.a)({},n),{},{name:"",email:"",password:"",error:"",success:e.data.message,buttonText:"Submitted"}))})).catch((function(e){a(Object(u.a)(Object(u.a)({},n),{},{error:e.response.data.error,buttonText:"Register"}))}))};return Object(r.jsxs)("div",{className:"col-md-6 offset-md-3",children:[Object(r.jsx)("h1",{className:"mb-4",children:"Register"}),Object(r.jsx)("br",{}),l&&V(l),Object(r.jsxs)("form",{onSubmit:h,children:[Object(r.jsx)("div",{className:"form-group",children:Object(r.jsx)("input",{value:s,onChange:d(),type:"text",name:"name",className:"form-control",placeholder:"Type your name"})}),Object(r.jsx)("div",{className:"form-group",children:Object(r.jsx)("input",{value:o,onChange:d(),type:"email",name:"email",className:"form-control",placeholder:"Type Email"})}),Object(r.jsx)("div",{className:"form-group",children:Object(r.jsx)("input",{value:i,onChange:d(),type:"password",name:"password",className:"form-control",placeholder:"Enter password here"})}),Object(r.jsx)("hr",{}),Object(r.jsx)("div",{className:"form-group",children:Object(r.jsx)("button",{className:"btn btn-light",children:b})})]}),j&&Object(r.jsxs)(r.Fragment,{children:[" ",X(j),Object(r.jsx)(g.b,{className:"btn btn-light mb-4 col-md-12",to:"/login",children:"Go to Login"})]})]})})),Y=function(){return Object(r.jsx)(g.a,{basename:"/",children:Object(r.jsxs)("div",{children:[Object(r.jsx)(E,{}),Object(r.jsx)("div",{className:"main-content",children:Object(r.jsxs)(f.d,{children:[Object(r.jsx)(K,{component:F,path:"/",exact:!0}),Object(r.jsx)(K,{component:J,path:"/gallery"}),Object(r.jsx)(f.b,{component:W,path:"/login"}),Object(r.jsx)(f.b,{component:Q,path:"/register"}),Object(r.jsx)(f.b,{component:B})]})})]})})};n(75),n(76);o.a.render(Object(r.jsx)(a.a.StrictMode,{children:Object(r.jsx)(i.a,{store:m,children:Object(r.jsx)(Y,{})})}),document.getElementById("root"))}},[[77,1,2]]]);
//# sourceMappingURL=main.f7898535.chunk.js.map