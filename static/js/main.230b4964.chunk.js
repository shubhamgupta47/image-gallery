(this["webpackJsonpimage-gallery"]=this["webpackJsonpimage-gallery"]||[]).push([[0],{76:function(e,t,r){},77:function(e,t,r){"use strict";r.r(t);var n=r(1),c=r(0),a=r.n(c),s=r(22),o=r.n(s),i=r(19),l=r(18),j=r(7),u={photos:[],loading:!0},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.photos;switch(r){case"LOAD_PHOTOS":return Object(j.a)(Object(j.a)({},e),{},{photos:n,loading:!1});default:return e}},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_ERRORS":return t.errors;default:return e}},h=r(43),m=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||l.d,O=Object(l.e)(Object(l.c)({gallery:b,errors:d}),m(Object(l.a)(h.a))),p=r(13),g=r(6),f=r(24),x=r.n(f),v=function(e,t){return x.a.get(e)},N=function(e,t){var r,n;r="token",n=e.data.token,x.a.set(r,n,{expires:1}),function(e,t){localStorage.setItem(e,JSON.stringify(t))}("user",e.data.user),t()},y=function(e){var t;t="token",x.a.remove(t),function(e){localStorage.removeItem(e)}("user"),e.push("/login")},S=Object(g.g)((function(e){var t=e.history;return Object(n.jsxs)("header",{children:[Object(n.jsx)("h1",{children:"PhotoGalleryApp"}),Object(n.jsx)("div",{className:"links",children:v("token")?Object(n.jsxs)(n.Fragment,{children:[" ",Object(n.jsx)(p.c,{to:"/",className:"link",children:"Home"}),Object(n.jsx)(p.c,{to:"/gallery",className:"link",children:"Gallery"}),Object(n.jsx)(p.c,{to:"/gallery",onClick:function(){return y(t)},className:"link",children:"Logout"})]}):Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(p.c,{to:"/login",className:"link",children:"Login"}),Object(n.jsx)(p.c,{to:"/register",className:"link",children:"Register"})]})})]})})),w=r(16),E=r(78),k=r(80),T=r(21),L=r.n(T),R=r(31),_=r(17),C=r.n(_),P="https://shubhamgupta47-image-gallery-api.glitch.me",D=function(e){return{type:"GET_ERRORS",errors:e}},I=function(e){return{type:"LOAD_PHOTOS",photos:e}},G=Object(i.b)((function(e){return{photos:e.photos||[],errors:e.errors||{}}}))((function(e){var t=e.errors,r=e.dispatch,s=Object(c.useState)(null),o=Object(w.a)(s,2),i=o[0],l=o[1],j=Object(c.useState)(!1),u=Object(w.a)(j,2),b=u[0],d=u[1],h=Object(c.useState)(null),m=Object(w.a)(h,2),O=m[0],p=m[1];Object(c.useEffect)((function(){p("Upload failed. Please try again.")}),[t.uploadError]),Object(c.useEffect)((function(){p("")}),[]);return Object(n.jsxs)(a.a.Fragment,{children:[O?Object(n.jsx)("p",{className:"errorMsg centered-message",children:O}):b&&Object(n.jsx)("p",{className:"successMsg centered-message",children:"Photo uploaded successfully."}),Object(n.jsxs)(E.a,{onSubmit:function(e){e.preventDefault(),i&&(p(""),r(function(e){return function(){var t=Object(R.a)(L.a.mark((function t(r){var n;return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(n=new FormData).append("photo",e),t.next=5,C.a.post("".concat(P,"/photos"),n,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(v("token"))}});case 5:t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),t.t0.response&&r(D({uploadError:t.t0.response}));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()}(i)),d(!0))},method:"post",encType:"multipart/form-data",className:"upload-form",children:[Object(n.jsxs)(E.a.Group,{children:[Object(n.jsx)(E.a.Label,{children:"Choose photo to upload"}),Object(n.jsx)(E.a.Control,{type:"file",name:"photo",onChange:function(e){var t=e.target.files[0];l(t)}})]}),Object(n.jsx)(k.a,{variant:"primary",type:"submit",className:"".concat(i?"submit-btn":"disabled submit-btn"),disabled:!i,children:"Upload"})]})]})})),A=function(){var e=function(){if(v("token")&&localStorage.getItem("user"))return JSON.parse(localStorage.getItem("user"))}().name;return Object(n.jsxs)("div",{className:"home-page",children:["Welcome ",e,Object(n.jsx)(G,{})]})},F=r(79),M=function(e){var t=e.id;return Object(n.jsx)(F.a,{className:"photo",children:Object(n.jsx)(F.a.Img,{variant:"top",src:"".concat(P,"/photos/").concat(t),alt:"Photo"})})},J=Object(i.b)((function(e){return{photos:e.gallery.photos||[],loading:e.gallery.loading,errors:e.errors||{}}}))((function(e){var t=e.errors,r=e.photos,a=e.loading,s=e.dispatch;return Object(c.useEffect)((function(){s(function(){var e=Object(R.a)(L.a.mark((function e(t){var r;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.a.get("".concat(P,"/photos"),{headers:{Authorization:"Bearer ".concat(v("token"))}});case 3:r=e.sent,t(I(r.data)),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.t0.response&&t(D({fetchingError:e.t0.response}));case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(n.jsxs)("div",{className:"photos-list",children:[t&&t.fetchingError&&!r.length&&Object(n.jsxs)("p",{className:"errorMsg centered-message",children:["Something doesn't seem right. Please try later.",Object(n.jsxs)("span",{children:["(",t.fetchingError.status,")"]})]}),a&&!t.fetchingError&&Object(n.jsx)("div",{className:"loading-msg centered-message",children:"Loading..."}),a||r.length?r.map((function(e){return Object(n.jsx)(M,{id:e._id},e._id)})):Object(n.jsx)("div",{className:"alert alert-secondary",children:"No photo available. "})]})})),B=function(){return Object(n.jsx)("div",{children:Object(n.jsx)("h3",{children:"Sorry, this page does not exist. Please use the links in navigation bar."})})},H=r(11),U=function(e){return Object(n.jsx)("div",{className:"alert alert-success",children:e})},z=function(e){return Object(n.jsx)("div",{className:"alert alert-danger",children:e})},X=Object(g.g)((function(e){var t=e.history,r=Object(c.useState)({email:"",password:"",error:"",success:"",buttonText:"Login"}),a=Object(w.a)(r,2),s=a[0],o=a[1];Object(c.useEffect)((function(){v("token")&&t.push("/")}),[]);var i=s.email,l=s.password,u=s.error,b=s.success,d=s.buttonText,h=function(){return function(e){var t,r=e.target;o(Object(j.a)(Object(j.a)({},s),{},(t={},Object(H.a)(t,r.name,r.value),Object(H.a)(t,"error",""),Object(H.a)(t,"success",""),Object(H.a)(t,"buttonText","Login"),t)))}},m=function(e){e.preventDefault(),o(Object(j.a)(Object(j.a)({},s),{},{buttonText:"Logging in..."})),C.a.post("".concat(P,"/login"),{email:i,password:l}).then((function(e){N(e,(function(){t.push("/")}))})).catch((function(e){o(Object(j.a)(Object(j.a)({},s),{},{error:e.response.data.error,buttonText:"Login"}))}))};return Object(n.jsxs)("div",{className:"col-md-6 offset-md-3",children:[Object(n.jsx)("h1",{className:"mb-4",children:"Login"}),Object(n.jsx)("br",{}),b&&U(b),u&&z(u),Object(n.jsxs)("form",{onSubmit:m,children:[Object(n.jsx)("div",{className:"form-group",children:Object(n.jsx)("input",{value:i,onChange:h(),type:"email",name:"email",className:"form-control",placeholder:"Type Email"})}),Object(n.jsx)("div",{className:"form-group",children:Object(n.jsx)("input",{value:l,onChange:h(),type:"password",name:"password",className:"form-control",placeholder:"Enter password here"})}),Object(n.jsx)("hr",{}),Object(n.jsx)("div",{className:"form-group",children:Object(n.jsx)("button",{className:"btn btn-light",children:d})})]})]})})),V=r(44),W=function(e){var t=e.component,r=Object(V.a)(e,["component"]);return Object(n.jsx)(g.b,Object(j.a)(Object(j.a)({},r),{},{render:function(e){return v("token")?Object(n.jsx)(t,Object(j.a)({},e)):Object(n.jsx)(g.a,{to:"/login"})}}))},q=Object(g.g)((function(){var e=Object(c.useState)({name:"",email:"",password:"",error:"",success:"",buttonText:"Register"}),t=Object(w.a)(e,2),r=t[0],a=t[1],s=r.name,o=r.email,i=r.password,l=r.error,u=r.success,b=r.buttonText,d=function(){return function(e){var t,n=e.target;a(Object(j.a)(Object(j.a)({},r),{},(t={},Object(H.a)(t,n.name,n.value),Object(H.a)(t,"error",""),Object(H.a)(t,"success",""),Object(H.a)(t,"buttonText","Register"),t)))}},h=function(e){e.preventDefault(),a(Object(j.a)(Object(j.a)({},r),{},{buttonText:"Registering"})),C.a.post("".concat(P,"/register"),{name:s,email:o,password:i}).then((function(e){a(Object(j.a)(Object(j.a)({},r),{},{name:"",email:"",password:"",error:"",success:e.data.message,buttonText:"Submitted"}))})).catch((function(e){a(Object(j.a)(Object(j.a)({},r),{},{error:e.response.data.error,buttonText:"Register"}))}))};return Object(n.jsxs)("div",{className:"col-md-6 offset-md-3",children:[Object(n.jsx)("h1",{className:"mb-4",children:"Register"}),Object(n.jsx)("br",{}),l&&z(l),Object(n.jsxs)("form",{onSubmit:h,children:[Object(n.jsx)("div",{className:"form-group",children:Object(n.jsx)("input",{value:s,onChange:d(),type:"text",name:"name",className:"form-control",placeholder:"Type your name"})}),Object(n.jsx)("div",{className:"form-group",children:Object(n.jsx)("input",{value:o,onChange:d(),type:"email",name:"email",className:"form-control",placeholder:"Type Email"})}),Object(n.jsx)("div",{className:"form-group",children:Object(n.jsx)("input",{value:i,onChange:d(),type:"password",name:"password",className:"form-control",placeholder:"Enter password here"})}),Object(n.jsx)("hr",{}),Object(n.jsx)("div",{className:"form-group",children:Object(n.jsx)("button",{className:"btn btn-light",children:b})})]}),u&&Object(n.jsxs)(n.Fragment,{children:[" ",U(u),Object(n.jsx)(p.b,{className:"btn btn-light mb-4 col-md-12",to:"/login",children:"Go to Login"})]})]})})),K=function(){return Object(n.jsx)(p.a,{basename:"/",children:Object(n.jsxs)("div",{children:[Object(n.jsx)(S,{}),Object(n.jsx)("div",{className:"main-content",children:Object(n.jsxs)(g.d,{children:[Object(n.jsx)(W,{component:A,path:"/",exact:!0}),Object(n.jsx)(W,{component:J,path:"/gallery"}),Object(n.jsx)(g.b,{component:X,path:"/login"}),Object(n.jsx)(g.b,{component:q,path:"/register"}),Object(n.jsx)(g.b,{component:B})]})})]})})};r(75),r(76);o.a.render(Object(n.jsx)(a.a.StrictMode,{children:Object(n.jsx)(i.a,{store:O,children:Object(n.jsx)(K,{})})}),document.getElementById("root"))}},[[77,1,2]]]);
//# sourceMappingURL=main.230b4964.chunk.js.map